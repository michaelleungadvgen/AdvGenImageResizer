<!DOCTYPE html>
<html>
<head>
    <title>Debug Template</title>
    <style>
        .photo-card { 
            width: 200px; 
            height: 200px; 
            background: #f0f0f0; 
            margin: 10px; 
            cursor: pointer; 
            border: 2px solid #ccc;
            display: inline-block;
            text-align: center;
            line-height: 200px;
        }
        .photo-card:hover { background: #e0e0e0; }
        .lightbox { 
            display: none; 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000;
        }
        .lightbox.active { display: flex; justify-content: center; align-items: center; }
        .lightbox-content { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            text-align: center;
            position: relative;
        }
        .close { 
            position: absolute; 
            top: 10px; right: 15px; 
            font-size: 24px; 
            cursor: pointer; 
        }
    </style>
</head>
<body>
    <h1>Debug Template - {{albumTitle}}</h1>
    
    <h2>Template Variables Debug:</h2>
    <ul>
        <li>isPaginated: {{isPaginated}}</li>
        <li>currentPage: {{currentPage}}</li>
        <li>totalPages: {{totalPages}}</li>
        <li>hasPrevPage: {{hasPrevPage}}</li>
        <li>hasNextPage: {{hasNextPage}}</li>
        <li>photoCount: {{totalPhotoCount}}</li>
    </ul>
    
    <h2>Conditional Test:</h2>
    {{#if isPaginated}}
    <p style="color: green;">✅ Pagination is ENABLED</p>
    {{/if}}
    
    {{#if hasPrevPage}}
    <p style="color: blue;">✅ Has Previous Page</p>
    {{else}}
    <p style="color: red;">❌ No Previous Page</p>
    {{/if}}
    
    {{#if hasNextPage}}
    <p style="color: blue;">✅ Has Next Page</p>
    {{else}}
    <p style="color: red;">❌ No Next Page</p>
    {{/if}}
    
    <h2>Photos:</h2>
    <div>
        {{#each photos}}
        <div class="photo-card" onclick="openLightbox({{@index}})">
            Photo {{@index}}: {{this.title}}
        </div>
        {{/each}}
    </div>

    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeLightbox()">&times;</span>
            <h3 id="lightbox-title">Photo Title</h3>
            <p id="lightbox-info">Photo info</p>
        </div>
    </div>

    <script>
        console.log('Debug template JavaScript starting...');
        
        const photos = [
            {{#each photos}}
            {
                title: "{{this.title}}",
                path: "{{this.relativePath}}"
            }{{#unless @last}},{{/unless}}
            {{/each}}
        ];
        
        console.log('Photos array:', photos);

        function openLightbox(index) {
            console.log('openLightbox called with index:', index);
            
            if (photos.length === 0) {
                console.log('No photos available');
                return;
            }
            
            const photo = photos[index];
            console.log('Selected photo:', photo);
            
            document.getElementById('lightbox-title').textContent = photo.title || 'Untitled';
            document.getElementById('lightbox-info').textContent = `Index: ${index}, Path: ${photo.path}`;
            
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            console.log('Lightbox opened');
        }

        function closeLightbox() {
            console.log('closeLightbox called');
            
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            console.log('Lightbox closed');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeLightbox();
            }
        });
        
        console.log('Debug template JavaScript loaded successfully');
    </script>
</body>
</html>